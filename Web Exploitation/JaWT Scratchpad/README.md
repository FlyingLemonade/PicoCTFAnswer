# JaWT Scratchpad

Check the admin scratchpad! (link)

# Hints

1. What is that cookie?
2. Have you heard of JWT?

# What I Did

I open the web try everything that clickable on the web.
<img src="Pic_1.jpg">

Shown in the image the word John below is underlined, and when
i clicked it, it moved me to this page https://github.com/openwall/john
it's a JohnTheRipper tool. So in this challange there is something i need
to bruteforce using JohnTheRipper.

After i type the name of John in the text field it gives me the note page.
<img src="Pic_2.jpg">

Based on the hints i check the cookie and found this cookie, and googled what is JWT
I get this cookie
`eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiSm9obiJ9.K1Omo0Gk5saKwJTkkgT7PUZohD7USknEE0lmT2AYAiM`
and i found this link https://jwt.io/
<img src="Pic_3.jpg">

JWT is basically a token used to authorization and information exchange.
This token might use HMAC, RSA or ECDSA, so i need to guess what algorithm it used.

The format of JWT token is xxxx.yyyy.zzzz (header.payload.signature)
Header and payload is encoded using base64.
We can see what algorithm used in the header, in this challange the cookie used HS256 for the signature.
<img src="Pic_4.jpg">

HS256 is a HMAC algorithm (Hash that used password).
I need to change the payload, from `John to admin` with the correct signature value, meaning i need to guess what the HMAC password is.
<img src="Pic_5.jpg">

To obtain the HMAC password, I used the JohnTheRipper tool as suggested in the challenge. I installed the tool from GitHub and referred to the documentation for installation instructions on my Linux system.
https://github.com/openwall/john/blob/bleeding-jumbo/doc/INSTALL

To use the tool, i referred to this resource
https://security.stackexchange.com/questions/134200/cracking-a-jwt-signature
but i didn't change my jwt to hexadecimal value.
the name of the file is `jwt.john`
<img src="Pic_6.jpg">

Then i run the tool using this syntax
(in the JohnTheRipper run directory)
`./john ~/PATH/jwt.john `
After a while it shows me the password of the HMAC, the password is
`ilovepico`
<img src="Pic_7.jpg">

I check if the password matches the hash. If it does, I use the password to generate a cookie. If this cookie matches the one from the server, the password is correct.
<img src="Pic_8.jpg">

Then i changed the payload to admin, and i changed to cookie with the cooke i
get from the jwt encoder
<img src="Pic_9.jpg">

Then after i put the new cookie, it gives me the flag
<img src="Pic_10.jpg">

The flag is

```

picoCTF{jawt_was_just_what_you_thought_1ca14548}

```
